
The **teacher (main actor)** is responsible for performing all **key actions (use cases)** such as **defining classes**, **adding students**, **marking attendance**, and **generating monthly reports**.

Let’s understand the **step-by-step sequence flow** of each use case to gain deeper insights into **how teachers interact with the system, how data flows during runtime, and how each feature functions within a memory-only environment**.

---
### Use Case 1: Create a New Class

A **`Teacher`** initiates the process by clicking the **"Create Class"** button from the UI. The UI displays the class creation form and prompts the teacher to enter class details such as **`className`** and **`teacherName`**. 

Upon submitting the form, the frontend sends a **`POST /createClass`** request to the **`AttendanceManagementSystem`**, including the input class details. 

The **`AttendanceManagementSystem`** extracts request parameters: **`className`** and **`teacherName`**, and invokes the **`createClass(className, teacherName)`** method within the **`ClassService`**. 

The **`createClass()`** method performs basic validations (e.g., check if **`className`** already exists), instantiates a new **`Class`** object: **`classObj`**  and invokes the **`save(classObj)`** method within the **`ClassRepository`**.

The **`save()`** method generates a unique **`classID`** and saves the **`classObj`** in the **in-memory** collection.

A success message is then returned to the UI, confirming that the class has been created.

```mermaid
sequenceDiagram
	participant T as Teacher
	participant UI as Frontend UI
	participant AMS as AttendanceManagementSystem
	participant CS as ClassService
	participant CR as ClassRepository

	Note over T,CR: Create New Class - Complete Flow

	T->>+UI: Click "Create Class" button
	UI-->>-T: Display class creation form

	T->>+UI: Fill form and click Submit
	Note right of T: Enter details:<br/>Class Name: "Mathematics Grade 10"<br/>Teacher Name: "John Smith"

	UI->>+AMS: POST /createClass
	Note right of UI: Send HTTP request with payload:<br/>{ "className": "Mathematics Grade 10", "teacherName": "John Smith" }

	AMS->>+CS: createClass("Mathematics Grade 10", "John Smith")
	Note right of AMS: Delegate to service layer with extracted parameters

	alt Class already exists
		CS->>+CR: findByName("Mathematics Grade 10")
		CR-->>-CS: Class already exists
		CS-->>AMS: return error: "Class already exists"
		AMS-->>UI: return HTTP 409 Conflict
		UI-->>T: Show error: "Class already exists"
	else New class creation
		CS->>CS: classObj = new Class("Mathematics Grade 10", "John Smith")
		CS->>+CR: save(classObj)
		CR->>CR: generateClassId()
		Note right of CR: Generate unique class ID: <br/> "CLASS_0001"
		CR->>CR: classes.put("CLASS_0001", classObj)
		CR-->>-CS: return "CLASS_0001"
		CS-->>-AMS: return "CLASS_0001"
		AMS-->>-UI: Class created successfully with ID: "CLASS_0001"
		UI-->>-T: Show confirmation: "Class created successfully!"
	end
```

---
### Use Case 2: Add a Student to Existing Class

The **`Teacher`** begins the process by clicking the **"Add Student"** button from the UI. The frontend sends a **`GET request`** to the **`AttendanceManagementSystem`** to fetch the list of existing classes.

The UI displays a list of existing classes, from which the **`Teacher`** selects the desired class (e.g., "Mathematics Grade 10"). The UI then displays the student details form and prompts the teacher to enter student details such as **`studentName`** and **`rollNumber`**.

Upon submitting the form, the frontend sends a **`POST /addStudent`** request to the **`AttendanceManagementSystem`**, including the selected **`classId`** and the student's information. 

The **`AttendanceManagementSystem`** extracts request parameters: **`classId`**, **`studentName`** and **`rollNumber`**, and invokes the **`addStudentToClass(classID,studentName,rollNumber)`** method within the **`ClassService`**.

The **`addStudentToClass()`** method performs basic validations, such as ensuring that the specified **`rollNumber`** does not already exist in the target class. If the validation succeeds, a new **`Student`** object: **`studentObj`** is created and added to the class’s **`studentMap<rollNumber, studentObj>`** collection via the **`ClassRepository`**. 

Finally, the **`AttendanceManagementSystem`** returns a success response to the UI, confirming the student was added.

```mermaid
sequenceDiagram
	participant T as Teacher
	participant UI as Frontend UI
	participant AMS as AttendanceManagementSystem
	participant CS as ClassService
	participant CR as ClassRepository

	Note over T,CR: Add Student to Class - Complete Flow

	T->>+UI: Click "Add Student" button
	UI->>+AMS: GET /classes
	AMS->>+CS: getAllClasses()
	CS->>+CR: findAll()
	CR-->>-CS: return List<Class>
	CS-->>-AMS: return List<Class>
	AMS-->>-UI: HTTP 200 OK
	UI-->>-T: Show "Student Details" form

	T->>+UI: Select class and enter student details
	Note right of T: Class ID: "CLASS_0001"<br/>Student Name: "Alice Johnson" <br/>Roll Number: "1"
	UI->>+AMS: POST /addStudent
	Note right of UI: { "classId": "CLASS_0001",<br/> "studentName": "Alice Johnson",<br/> "rollNumber": "1" }
	AMS->>+CS: addStudentToClass("CLASS_0001", "Alice Johnson", "1")
	CS->>+CR: findById("CLASS_0001")
	Note right of CS: Retrieve the target class
	CR->>CR: classObj = classes.get("CLASS_0001")
	CR-->>-CS: return classObj

	alt Roll Number Already Exists
		CS->>CS: classObj.getStudentMap().containsKey("1")
		CS-->>AMS: return error: "Roll Number already exists"
		AMS-->>UI: HTTP 409 Conflict
		UI-->>T: Show error: "Roll Number already exists"
	else New Student Creation
		CS->>CS: studentObj = new Student("Alice Johnson", "1")
		CS->>CS: classObj.getStudentMap().put("1", studentObj)
		CS-->>-AMS: return message: "Student Added Successfully"
		AMS-->>-UI: HTTP 200 OK
		UI-->>-T: Show message: "Student Added Successfully"
	end
```

> **NOTE:** 
> 
> For **in-memory system**, where the teacher creates classes and adds students **per session**, it's better to **let the teacher input the roll number**. This provides more control and aligns well with existing school records or legacy systems.

---
### Use Case 3: Mark Daily Attendance

The **`Teacher`** begins the process by clicking the **"Mark Attendance"** button from the UI. The frontend sends a **`GET /classes`** request to the **`AttendanceManagementSystem`** to fetch the list of existing classes.

The UI displays a list of existing classes, from which the **`Teacher`** selects the desired class (e.g., "Mathematics Grade 10"). The UI then displays a form showing **`List<Student>`** in the selected **`Class`** and prompts the **`Teacher`** to go through each **`Student`** and mark its **`AttendanceStatus`** as **`Present`** or **`Absent`**.

Upon submitting the form, the frontend sends a **`POST /markAttendance`** request to the **`AttendanceManagementSystem`**, including **`todayDate`**, **`classId`** and **`Map<rollNumber, AttendanceStatus>`**. 

The **`AttendanceManagementSystem`** extracts request parameters: **`todayDate`**, **`classId`** and **`Map<rollNumber, AttendanceStatus>`**, and invokes the  **`markAttendance(classId,todayDate,Map<rollNumber, AttendanceStatus>)`** method within the **`AttendanceService`**.

The **`markAttendance()`** method performs basic validations, such as ensuring that the **`Map<rollNumber, AttendanceStatus>`** for **`todayDate`** for the **target class** is not already present in the **`AttendanceRecord`**. 

If the validation succeeds, a new **`Map<todayDate, Map<rollNumber, AttendanceStatus>`** entry is added to the **`AttendanceRecord`** of the **target class** via the **`save(classId, Map<todayDate, Map<rollNumber, AttendanceStatus>)`** method of **`AttendanceRepository`**.

Finally, the **`AttendanceManagementSystem`** returns a success response to the UI, confirming the attendance for all students in the target class is marked for today.

```mermaid
sequenceDiagram
	participant T as Teacher
	participant UI as Frontend UI
	participant AMS as AttendanceManagementSystem
	participant AS as AttendanceService
	participant AR as AttendanceRepository
	participant CS as ClassService
	participant CR as ClassRepository

	Note over T, CR: Mark Daily Attendance - Complete Flow

	T->>+UI: Click "Mark Attendance" button
	UI->>+AMS: GET /classes
	AMS->>+CS: getAllClasses()
	CS->>+CR: findAll()
	CR-->>-CS: return List<Class>
	CS-->>-AMS: return List<Class>
	AMS-->>-UI: HTTP 200 OK
	UI-->>-T: Display class list

	T->>+UI: Select class and date
	Note right of T: Class ID: "CLASS_0001" <br/> Date: "6-Aug-2025"
	UI->>+AMS: GET /students?classId=CLASS_0001
	AMS->>+CS: getAllStudentsInClass("CLASS_0001")
	CS->>+CR: getAllStudents("CLASS_0001")
	CR-->>-CS: return List<Student>
	CS-->>-AMS: return List<Student>
	AMS-->-UI: HTTP 200 OK
	UI-->>-T: Display student list with Present/Absent options

	T->>+UI: Mark attendance for each student
	UI->>+AMS: POST /markAttendance
	Note right of UI: { "classId": "CLASS_0001", <br/> "todayDate": "6-Aug-2025", <br/> "attendanceMap": {rollNumber, AttendanceStatus} }
	AMS->>+AS: markAttendance(classId, todayDate, Map<rollNumber, AttendanceStatus>)
	Note right of AMS: Delegate to service layer

	AS->>+AR: isAttendanceMarked(classId, todayDate)
	alt Attendance Already Marked
		AR-->>AS: true
        AS-->>AMS: return error: "Attendance already exists"
        AMS-->>UI: HTTP 409 Conflict
        UI-->>T: Show error: "Attendance already exists"
    else Mark Attendance
        AR-->>-AS: false
        AS->>+AR: save("CLASS_0001", Map<todayDate, Map<rollNumber, AttendanceStatus>)
        AR-->>-AS: attendanceRecord.put("CLASS_0001", Map<todayDate, Map<rollNumber, AttendanceStatus>)
        AS-->>-AMS: Success
        AMS-->>-UI: HTTP 200 OK
        UI-->>-T: Show success message: "Attendance marked successfully"
    end
```

> **NOTE:** 
> 
> It's better to store **attendance records as a separate entity** rather than embedding them inside the **`Class`** object. 
> 
> While storing attendance within `Class` object keeps everything in one place, it tightly couples responsibilities and makes the class harder to manage. Let the **`Class`** object focus only on class metadata and enrolled students. 
> 
> This aligns with the **Single Responsibility Principle** and makes the system easier to extend for features like reporting or persistence later.

---
### Use Case 4: Generate Monthly Class Attendance Report

The **`Teacher`** begins the process by clicking the **"View Attendance Report"** button from the UI. The frontend sends a **`GET /classes`** request to the **`AttendanceManagementSystem`** to fetch the list of existing classes.

The UI then displays a list of existing classes and prompts the **`Teacher`** to choose a specific **class (e.g., "Mathematics Grade 10")**, **year** and **month**.

Upon submitting the form, the frontend sends a **`GET /attendanceReport`** request to the **`AttendanceManagementSystem`**, including the selected **`classId`**, **`year`** and **`month`** as parameters.

The **`AttendanceManagementSystem`** extracts request parameters: **`classId`**, **`year`** and **`month`**, and invokes the  **`generateAttendanceReport(classId,year, month)`** method within the **`ReportService`**.

The **`generateAttendanceReport()`** method invokes the **`getAttendanceRecord(classId)`** method within the **`AttendanceRepository`** to retrieve the **`AttendanceRecord`** for the specified class.

The **`generateAttendanceReport()`** method method then performs some basic validations, such as ensuring that at least one record exist in the **`AttendanceRecord`** that fall within the given month. If the validation succeeds, it aggregates **`AttendanceRecord`** to compute, for each **`Student`**, the number of days marked as **Present** and **Absent**. 

The resulting **`ClassAttendanceReport`** is structured as a **`List<StudentAttendanceStats>`**, containing every individual student's attendance summaries for the month. 

Finally, the aggregated **`ClassAttendanceReport`** is returned to the frontend, where it is typically presented in a tabular format like:

| Roll Number | Name  | Total Present | Total Absent | Attendance % |
| ----------- | ----- | ------------- | ------------ | ------------ |
| 1           | Alice | 20            | 2            | 91.3         |
| 2           | Bob   | 18            | 3            | 86.9         |

```mermaid
sequenceDiagram
	participant T as Teacher
	participant UI as Frontend UI

```


---




