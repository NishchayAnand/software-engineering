
The **Attendance Management System** should allow a **teacher (main actor)** to perform **key actions (use cases)** such as:

1. Create a new class.
2. Add a student to an existing class.
3. Mark daily class attendance.
4. Generate monthly class attendance reports.

Let’s understand the step-by-step sequence flow of each use case to gain deeper insights into <span style="color:green;font-weight:bold;background:beige;">how teachers interact with the system, how data flows during runtime, and how each feature functions within a memory-only environment</span>.

---
### Create a New Class

This use case allows a teacher to define a new class at the beginning of an academic session. The following interactions describe the step-by-step flow of this operation between the user interface and backend components.

**Interaction 1: Click the "Create Class" Button**

1. A `Teacher` initiates the process by clicking the `Create Class` button from the UI. 
2. The UI displays the class creation form and prompts the teacher to enter class details such as `className` and `teacherName`.

**Interaction 2: Submit the "Create Class" Form**

1. Upon submitting the form, the frontend sends a `POST /create-class` request to the `AttendanceManagementSystem`, including the input class details. 
2. The `AttendanceManagementSystem` intercepts the request, extracts request parameters: `className` and `teacherName`, and invokes the `createClass(className, teacherName)` method within the `ClassService`.
3. The `createClass()` method validates if a class with the same name already exists. Upon successful validation, it generates a unique `classId`, instantiates a new `ClassObject`  and saves the `{classId, classObject}` combination in the in-memory class registry.
4. An `HTTP response` is returned to the UI, stating whether the class has been created or not.

**Sequence Diagram**

```mermaid
sequenceDiagram
	participant T as Teacher
	participant UI as Frontend UI
	participant AMS as AttendanceManagementSystem
	participant CS as ClassService

	Note over T,CS: Create New Class - Complete Flow

	%% Interaction 1: Click the "Create Class" Button
	T->>+UI: Click "Create Class" button
	UI-->>-T: Display class creation form

	%% Interaction 2: Submit the "Create Class" Form
	T->>+UI: Fill "Create Class" form and click Submit
	Note right of T: Enter Details: <br/> Class Name: "Mathematics - Grade 10" <br/> Teacher Name: "Mrs. Anjali Sharma"
	UI->>+AMS: POST /createClass
	AMS->>+CS: createClass(className, teacherName)

	alt Class already exists
		CS-->>AMS: return error: "Class already exists"
		AMS-->>UI: return HTTP 409 Conflict
		UI-->>T: Show error: "Class already exists"
	else Create New Class
		Note left of CS: 1. Generate unique classId <br/> 2. Instantiate new ClassObject <br/> 3. Save {classId, classObject}
		CS-->>-AMS: return classObject
		AMS-->>-UI: return HTTP 201 Created
		UI-->>-T: Show confirmation: "Class created successfully!"
	end
```

---
### Add a Student to Existing Class

This use case enables a teacher to add a new student to one of its assigned class. The following interactions outline the complete step-by-step flow from initiating the action to successful student registration.

**Interaction 1: Click the "Add Student" Button**

1. The `Teacher` begins the process by clicking the `Add Student` button from the UI. 
2. The frontend sends a A `GET request` to the `AttendanceManagementSystem` to pre-populate class dropdown menu with the list of existing classes.
3. The UI then displays the add student details form, and prompts the teacher to select the desired class (e.g., `Mathematics Grade 10`) and enters student details such as `name` and `enrollmentId`.

**Interaction 2: Submit the "Add Student Details" Form**

1. Upon submitting the form, the frontend sends a `POST /addStudent/{classId}` request to the `AttendanceManagementSystem`, including the student's details.
2. The `AttendanceManagementSystem` intercepts the request, extracts request parameters: `classId`, `name` and `enrollmentId`, and invokes the `addStudent(classId, name, enrollmentNumber)` method within the `ClassService`.
3. The `addStudent()` method validates whether a student with the same `enrollmentId` already exists in the target class. Upon successful validation, it instantiates a new `studentObject` and adds the `{enrollmentId, studentObject}` combination to the student registry of the target class.
4. An `HTTP response` is returned to the UI, confirming whether the student has been added to the target class or not.

**Sequence Diagram**

```mermaid
sequenceDiagram
	participant T as Teacher
	participant UI as Frontend UI
	participant AMS as AttendanceManagementSystem
	participant CS as ClassService

	Note over T,CS: Add Student to Class - Complete Flow

	%% Interaction 1: Click the "Add Student" Button
	T->>+UI: Click "Add Student" button
	UI->>+AMS: GET /classes
	AMS->>+CS: getClasses()
	CS-->>-AMS: return List<Class>
	AMS-->>-UI: HTTP 200 OK
	UI-->>-T: Show "Student Details" form

	%% Interaction 2: Submit "Add Student Details" Form
	T->>+UI: Fill "Add Student Details" form and click Submit
	Note right of T: Enter Details: <br/> Class Id: "CLASS_0001"<br/>Student Name: "Alice Johnson" <br/>Enrollment Id: "STU_0001"
	UI->>+AMS: POST /addStudent/{classId}

	AMS->>+CS: addStudent("CLASS_0001", "Alice Johnson", "STU_001")
	alt Student Already Exists
		CS-->>AMS: return error: "Student in class: "CLASS_0001" already exists"
		AMS-->>UI: HTTP 409 Conflict
		UI-->>T: Show error: "Student in class: "CLASS_0001" already exists"
	else New Student Creation
		Note left of CS: 1. Instantiate new studentObject <br/> 2. Save {enrollmentId, StudentObject} in target class
		CS-->>-AMS: return message: "Student Added Successfully"
		AMS-->>-UI: HTTP 201 Created
		UI-->>-T: Show message: "Student Added Successfully"
	end
```

---
### Mark Daily Attendance

This use case allows a teacher to record daily attendance for students in a selected class. The interactions below describe this flow in detail.

**Interaction 1: Click the "Mark Attendance" Button**

1. The `Teacher` begins the process by clicking the `Mark Attendance` button from the UI. 
2. The frontend sends a `GET /classes` request to the `AttendanceManagementSystem` to pre-populate the select class drop down with the list of existing classes.
3. The UI then displays a select class form and prompts the teacher to select the desired class (e.g., `Mathematics Grade 10`). 

**Interaction 2: Fill the "Mark Attendance" Form**

1. Upon selecting a class, the frontend sends a `GET /students` to the `AttendanceManagementSystem` to populate the mark attendance from with the `List<Student>` in the target class. 
2. The UI then displays the mark attendance form and prompts the teacher to go through each `Student` and mark its attendance status as `PRESENT` or `ABSENT`.

**Interaction 3: Submit "Mark Attendance" Form**

1. Upon submitting the form, the frontend sends a `POST /markAttendance/{classId}` request to the `AttendanceManagementSystem`, including today's `date` and `List<AttendanceRecord>`.
2. The `AttendanceManagementSystem` intercepts the requests, extracts request parameters: `classId`, `date` and `List<AttendanceRecord>`, and invokes the  `markAttendance(classId, date, List<AttendanceRecord>)` method within the `ClassService`.
3. The `markAttendance()` method validates whether the attendance for the target class for today's `date ` is already marked or not. Upon successful validation, it adds the `{date, List<AttendanceRecord>}` combination to the attendance registry of the target class.
4. An `HTTP response` is returned to the UI, confirming whether the attendance for all students in the target class is marked for today or not.

**Sequence Diagram**

```mermaid
sequenceDiagram
	participant T as Teacher
	participant UI as Frontend UI
	participant AMS as AttendanceManagementSystem
	participant CS as ClassService

	Note over T, CS: Mark Daily Attendance - Complete Flow

	%%Interaction 1: Click the "Mark Attendance" Button
	T->>+UI: Click "Mark Attendance" button
	UI->>+AMS: GET /classes
	AMS->>+CS: getAllClasses()
	CS-->>-AMS: return List<Class>
	AMS-->>-UI: HTTP 200 OK
	UI-->>-T: Display "Select Class" Dropdown

	%%Interaction 2: Fill the "Mark Attendance" Form
	T->>+UI: Select Class
	Note right of T: Class ID: "CLASS_0001"
	UI->>+AMS: GET /students/CLASS_0001
	AMS->>+CS: getStudents("CLASS_0001")
	CS-->>-AMS: return List<Student>
	AMS-->-UI: HTTP 200 OK
	UI-->>-T: Display student list with PRESENT / ABSENT checkbox

	%%Interaction 3: Submit "Mark Attendance" Form
	T->>+UI: Mark PRESENT / ABSENT for each student and click Submit
	UI->>+AMS: POST /markAttendance/CLASS_0001
	AMS->>+CS: markAttendance(classId, date, List<AttendanceRecord>)
	Note over CS: 1. classObject = classMap.get("CLASS_0001") <br/> 2. attendanceRecords = classObject.getAttendanceRecords() <br/> 3. Check if attendancRecords.containsKey(date)

	alt Attendance Already Marked
        CS-->>AMS: return error: "Attendance already exists"
        AMS-->>UI: HTTP 409 Conflict
        UI-->>T: Show error: "Attendance already exists"
    else Mark Attendance
        Note over CS: 1. attendanceRecords.put(date, List<AttendanceRecord>)
        CS-->>-AMS: return message: "Attendance marked successfully"
        AMS-->>-UI: HTTP 200 OK
        UI-->>-T: Show message: "Attendance marked successfully"
    end
```

---
### Generate Monthly Class Attendance Report

This use case allows a teacher to generate and view the monthly attendance summary for a selected class. The interactions below illustrate the step-by-step process of how this report is generated and delivered to the teacher through the UI.

**Interaction 1: Click the "View Attendance Report" button**

1. The `Teacher` clicks the "View Attendance Report" button from the UI. 
2. The frontend sends a `GET /classes` request to the `AttendanceManagementSystem` to pre-populate the class dropdown menu with the list of existing classes and prompts the `Teacher` to choose a specific class (e.g., "Mathematics Grade 10"), year and month.

**Interaction 2: Submit "Select Class and Month" Form**

1. Upon submitting the form, the frontend sends a `GET /attendanceReport` request to the `AttendanceManagementSystem`, including the selected `classId`, `year` and `month` as parameters.
2. The `AttendanceManagementSystem` extracts request parameters: `classId`, `year` and `month`, and invokes the  `generateClassAttendanceReport(classId,year, month)` method within the `ReportService`.
3. The `generateClassAttendanceReport()` method invokes the `getAttendanceRecord(classId)` method within the `AttendanceRepository` to retrieve the `AttendanceRecord` for the specified class and performs basic validations such as ensuring that at least one record exist in the `AttendanceRecord` that fall within the given month. 
4. If the validation succeeds, it aggregates `AttendanceRecord` to compute, for each `Student`, the number of days marked as `Present` and `Absent`. The resulting `ClassAttendanceReport` is structured as a `List<StudentAttendanceStats>`, containing every student's attendance summaries for the month.
5. Finally, the `AttendanceManagementSystem` returns the aggregated `ClassAttendanceReport` to the frontend, where it is typically presented in a tabular format like:

| Roll Number | Name  | Total Present | Total Absent | Attendance % |
| ----------- | ----- | ------------- | ------------ | ------------ |
| 1           | Alice | 20            | 2            | 91.3         |
| 2           | Bob   | 18            | 3            | 86.9         |

**Sequence Diagram**

```mermaid
sequenceDiagram
    participant T as Teacher
    participant UI as Frontend UI
    participant AMS as AttendanceManagementSystem
    participant RS as ReportService
    participant AR as AttendanceRepository
    participant CS as ClassService
    participant CR as ClassRepository

    Note over T,CR: View Monthly Class Attendance Report – Complete Flow

	%%Interaction 1: Click the "View Attendance Report" button
    T->>+UI: Click "View Attendance Report"
    UI->>+AMS: GET /classes
    AMS->>+CS: getAllClasses()
	CS->>+CR: findAll()
	CR-->>-CS: Return List<Class>
	CS-->>-AMS: Return List<Class>
	AMS-->>-UI: HTTP 200 OK
	UI-->>-T: Display class dropdown

	%%Interaction 2: Submit "Select Class and Month" Form
    T->>+UI: Select class, year, and month
    Note right of T: e.g., ClassId = "CLASS_0001", Year = 2025, Month = 08
    UI->>+AMS: GET /attendanceReport?classId=CLASS_0001&year=2025&month=08
    AMS->>+RS: generateAttendanceReport("CLASS_0001", 2025, 8)
    Note right of AMS: Delegate to reporting service
    RS->>+AR: getAttendanceRecord("CLASS_0001")
    AR-->>-RS: Return Map<LocalDate, Map<rollNumber, AttendanceStatus>>
    Note over RS: Filter records for year = 2015 & month = 08
	alt Records exist for the given month
		Note over RS: Compute Present/Absent per student
		RS-->>AMS: Return List<StudentAttendanceStats>
		AMS-->>UI: HTTP 200 OK with ClassAttendanceReport
		UI-->>T: Display tabular report: Student Name, Roll No., Present, Absent
	else No records found for the given month
		RS-->>-AMS: Return "No Records Found" message
		AMS-->>-UI: Return "No Records Found" response
		UI-->>-T: Display "No Records Found" message
	end
```

---



