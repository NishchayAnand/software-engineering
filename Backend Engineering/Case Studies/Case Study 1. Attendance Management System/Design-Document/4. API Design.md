
The **Attendance Management System APIs** are structured into four primary resource groups, each addressing a core aspect of the system: **Class API**, **Student API**, **Attendance API**, and **Report API**.

Let's discuss each in detail, outlining their endpoints, request formats, business logic and response structures.

---
### Class API

Responsible for managing all operations related to class creation and retrieval of class details.

<span style="color:green;font-weight:bold;">Endpoint 1:</span> `POST /create-class`

Use this endpoint to **create a new class**. It accepts class details such as the class `name` and `teacherName` in the request body. 

<span style="color:purple;font-weight:bold;">Sample Request Body</span>

```
{
  "name": "Mathematics - Grade 10",
  "teacherName": "Mrs. Anjali Sharma"
}
```

The `AttendanceManagementSystem` intercepts the request, extracts request parameters: `name` and `teacherName`, and invokes the `createClass(name, teacherName)` method within the `ClassService`.

<span style="color:purple;font-weight:bold;">Business Logic</span>

```
public boolean createClass(String name, String teacherName) {  

    // Step 1: Check if class with same name already exists  
    boolean exists = classMap.values().stream()  
            .anyMatch(obj->obj.getName().equalsIgnoreCase(req.getClassName()));  
    if(exists) return false;  
  
    // Step 2: Create a new class  
    String classId = generateClassId();  
    Class class = new Class(classId, req.getClassName(), req.getTeacherName());  
    classMap.put(classId, class);  
    return true;

}
```

<span style="color:purple;font-weight:bold;">Class Id Generator</span>

```
private int classCounter;

private String generateClassId() {  
    return "CLASS_" + String.format("%04d", ++classCounter);  
}
```

Upon successful creation (`HTTP 201 Created`), the `AttendanceManagementSystem` returns a `statusMessage` confirming the class has been created successfully, while failures return the appropriate error status code (e.g., `HTTP 409 Conflict`).

<span style="color:purple;font-weight:bold;">Sample Response Body</span>

```
Class created successfully
```

<span style="color:green;font-weight:bold;">Endpoint 2:</span> `GET /classes`

Use this endpoint to **retrieve all available classes**. It accepts no request body.

The `AttendanceManagementSystem` intercepts the request and invokes the `getAllClasses()` method within the `ClassService`.

<span style="color:purple;font-weight:bold;">Business Logic</span>

```
public List<ClassEntity> getAllClasses() {  
    return classRegistry.values();  
}
```

Upon successful retrieval (`HTTP 200 OK`), `AttendanceManagementSystem` returns a JSON array containing each class’s unique `classId` and `name`, while an empty result returns `HTTP 204 No Content`.

<span style="color:purple;font-weight:bold;">Sample Response</span>

```
[
  {
    "classId": 101,
    "className": "Mathematics - Grade 10",
  },
  {
    "classId": 102,
    "className": "Science - Grade 10",
  }
]
```

---
### Student API

Responsible for managing student enrollment within classes and retrieving student details.

<span style="color:green;font-weight:bold;">Endpoint 1:</span> `POST /add-student/{classId}`

Use this endpoint to add a new student to the specified class. It accepts the student’s details in the request body and uses the `classId` provided in the path parameter to identify the target class.

<span style="color:purple;font-weight:bold;">Sample Request Body</span>

```
{
  "enrollmentId": "STU_0001",
  "name": "John Doe"
}
```

The `AttendanceManagementSystem` intercepts the request, extracts request parameters: `classId`, `name` and `enrollmentId`, and invokes the `addStudent(classId, enrollmentId, name)` method within the `ClassService`.

<span style="color:purple;font-weight:bold;">Business Logic</span>

```
public boolean addStudent(String classId, String enrollmentId, String name) {  

    // Step 1: Check if the student already exists in the class 
    ClassEntity classEntity = classRegistry.get(classId);   
    boolean exists = classEntity.getStudents().containsKey(enrollmentId);  
    if(exists) return false;  
 
    // Step 2: Create a student and add it to the target class  
    StudentEntity studentEntity = new StudentEntity(enrollmentId, name);  
    classEntity.getStudents().put(enrollmentId, studentEntity);  
    return true; 

}
```

Upon successful creation (`HTTP 201 Created`), the `AttendanceManagementSystem` returns the student’s unique ID along with the full student record, while failures return the appropriate error status code (e.g., `HTTP 409 Conflict`).

<span style="color:purple;font-weight:bold;">Sample Response Body</span>

```
Student added successfully
```

<span style="color:green;font-weight:bold;">Endpoint 2:</span> `GET /students/{classId}`

Use this endpoint to fetch all students enrolled in a given class. It accepts no request body and uses the `classId` provided in the path parameter to identify the target class.

The `AttendanceManagementSystem` intercepts the request and invokes `getStudents(classId)` method within the `ClassService`.

<span style="color:purple;font-weight:bold;">Business Logic</span>

```
public List<StudentEntity> getStudents(String classId) {  
    return classRegistry.get(classId).getStudentRegistry().values();  
}
```

Upon successful retrieval (`HTTP 200 OK`), the `AttendanceManagementSystem` returns details of each student in the class, while failures return the appropriate error status code (e.g., `HTTP 400 Bad Request`).

<span style="color:purple;font-weight:bold;">Sample Response Body</span>

```
[
    {
      "enrollmentId": "STU-001",
      "name": "Riya Verma"
    },
    {
      "enrollmentId": "STU-002",
      "name": "Arjun Singh"
    },
    {
      "enrollmentId": "STU-003",
      "name": "Meena Kapoor"
    }
]
```

> **NOTE:** All endpoints are scoped under a `classId`, since a student cannot exist outside a class in our in-memory design.

---
### Attendance API

Responsible for marking and retrieving attendance records for students in a class.

<span style="color:green;font-weight:bold;">Endpoint 1:</span> `POST /mark-attendance/{classId}`

Use this endpoint to mark the attendance for students in a specific class. It accepts the `classId` as a path variable and the attendance details such as today's date and individual student attendance status in the request body.

<span style="color:purple;font-weight:bold;">Sample Request Body</span>

```
{
	"date": "2025-08-12",
	"records": [
		{ 
		    "enrollmentId": "STU_0001", 
		    "studentName": "Alice",
		    "status": "PRESENT"
		},
	    { 
		    "enrollmentId": "STU_0002", 
		    "studentName": "Bob",
		    "status": "ABSENT" 
		}
	  ]
}
```

The `AttendanceManagementSystem` intercepts the requests, extracts request parameters: `classId`, `date` and `List<StudentAttendanceRecord>`, and invokes the  `markAttendance(classId, date, List<StudentAttendanceRecord>)` method within the `ClassService`.

<span style="color:purple;font-weight:bold;">Business Logic</span>

```
public boolean markAttendance(String classId, LocalDate date, 
											List<AttendanceRecord> records) {  
  
    // Step 1: Check if attendance for today's date is already marked
    Class class = classMap.get(classId);  
    boolean exists = class.getAttendanceRecords().containsKey(date);  
    if(exists) return false;
     
    // Step 2: Add attendance records for today's date to the target class  
    class.getAttendanceRecords().put(date, records);  
    return true;
     
}
```

Upon successful marking of attendance (`HTTP 200 OK`), the response returns a confirmation message, while failure (`HTTP 400 Bad Request`) returns an error message detailing the reason.

<span style="color:purple;font-weight:bold;">Sample Response Body</span>

```
Attendance marked successfully
```

----
### Report API

Responsible for generating attendance reports for classes over a specified date range.

<span style="color:green;font-weight:bold;">Endpoint 1:</span> `GET /attendance-report/{classId}`

Use this endpoint to generate the attendance report for a specific class. It accepts the `classId` provided as a path parameter and the reporting window in the request body.

<span style="color:purple;font-weight:bold;">Sample Request Body</span>

```
{
  "startDate": "2025-08-01",
  "endDate": "2025-08-15"
}
```

The `AttendanceManagementSystem` intercepts the request, extracts request parameters: `classId`, `startDate` and `endDate` and invokes the `generateAttendanceReport(classId, startDate, endDate)` method within the `ClassService`.

<span style="color:purple;font-weight:bold;">Business Logic</span>

```
public ClassAttendanceReport generateAttendanceReport(String classId, 
									LocalDate startDate, LocalDate endDate) {  
  
    // Step 1: Filter AttendanceRecords between startDate and endDate  
    ClassEntity classEntity = classMap.get(classId);  
    Map<LocalDate, List<StudentAttendanceRecord>> records = 
									classEntity.getStudentAttendanceRecords();  
    List<StudentAttendanceRecord> filteredRecords = records.entrySet().stream()  
            .filter(entry -> !entry.getKey().isBefore(startDate) && 
									        !entry.getKey().isAfter(endDate))  
            .flatMap(entry -> entry.getValue().stream())  
            .toList();  
  
    // Step 2: Populate each student's StudentAttendanceStats  
    Map<String, StudentAttendanceStats> statsMap = new HashMap<>();  
    for(StudentAttendanceRecord record: filteredRecords) {  
        StudentAttendanceStats stats = statsMap.computeIfAbsent(
		        record.getEnrollmentId(),  
                k -> new StudentAttendanceStats(record.getEnrollmentId(),
								                record.getName()));  
        switch(record.getStatus()) {  
            case "PRESENT": 
	            stats.setTotalPresent(stats.getTotalPresent()+1); 
	            break;  
            case "ABSENT": 
	            stats.setTotalAbsent(stats.getTotalAbsent()+1); 
	            break;  
        }  
    }  
  
    // Step 3: Calculate the attendance percentage for each student  
    int totalDaysRecorded = filteredRecords.size();  
    for(Map.Entry<String, StudentAttendanceStats> entry: statsMap.entrySet()) {  
        double percent = entry.getValue().getTotalPresent() / totalDaysRecorded;
        entry.getValue().setAttendancePercentage(percent);  
    }  
  
    // Step 4: Create the attendance report  
    List<StudentAttendanceStats> attendanceSummary = statsMap.values();  
    return new ClassAttendanceReport(classEntity.getName(), startDate, endDate,
														     attendanceSummary);
}
```

Upon successful processing (`HTTP 200 OK`), it returns a structured report summarizing a **aggregate summary** for each student in the target class, while any errors result in appropriate error responses (e.g., `HTTP 400 Bad Request`).

<span style="color:purple;font-weight:bold;">Sample Response Body</span>

```
{
	"className": "Mathematics - Grade 10",
	"startDate": "2025-08-01",
    "endDate": "2025-08-15",
	"attendanceSummary": [
		{
		    "enrollmentId": "STU_0001",
		    "studentName": "Alice",
		    "totalPresent": 20,
		    "totalAbsent": 2,
		    "attendancePercentage": 91.3
	    },
	    {
		    "enrollmentId": "STU_0002",
		    "studentName": "Bob",
		    "totalPresent": 18,
		    "totalAbsent": 3,
		    "attendancePercentage": 86.9
	    }
	]
}
```

---
