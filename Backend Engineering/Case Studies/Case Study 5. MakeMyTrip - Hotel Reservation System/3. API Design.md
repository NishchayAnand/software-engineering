
The **Hotel Reservation System** can be organized into four main API groups, each focused on a core function of the platform: 

1. **Inventory API**: Act as the single source of truth for real-time room availability and allocation.
2. **Hotel API**:
3. **Reservation API**:
4. **Pricing API**:

Let's explore each of these in detail, covering their key aspects such as core endpoints, request and response structures, underlying business logic, and estimated load expectations.

---
### Inventory API

Its primary use case is to answer two critical questions at any moment:

1. Is this room type actually available for these dates?
2. Can I safely lock this room for a customer until they finish booking?

<span style="color:purple;font-weight:bold">Endpoint 1:</span>  `GET /inventory/hotels?destination=...&check-in-date=...&check-out-date=...`

Use this endpoint to fetch the list of hotels that have at least one bookable room for the selected query parameters: `destination`, `check-in-date`, and `check-out-date`. 

It accepts no request body.

<span style="color:green;font-weight:bold">Business Logic</span>

```
public List<HotelSearchResult> searchHotels(destination, checkIn, checkOut):

    // Step 1: Fetch hotel metadata for destination
    hotels = HotelAPI.getHotelsByDestination(destination)
    // hotels: [{hotel_id, name, thumbnail, room_type_ids, ...}, ...]

    if hotels is empty:
        return { results: [] }

    // 3. query inventory for availability across the date range
    hotelIds = hotels.map(h => h.hotel_id)
    inventoryResp = InventoryAPI.query({
      hotel_ids: hotelIds,
      check_in_date: checkIn,
      check_out_date: checkOut
    })
    // inventoryResp.results: [{hotel_id, available:bool, room_types: [{room_type_id, available_rooms, as_of, stale}, ...]}, ...]

    // 4. filter hotels that have at least one available room type
    availableHotels = []
    for each hotel in hotels:
        inv = find(inventoryResp.results, r => r.hotel_id == hotel.hotel_id)
        if inv is null or inv.available == false:
            continue
        availableRoomTypes = inv.room_types.filter(rt => rt.available_rooms > 0).map(rt => rt.room_type_id)
        if availableRoomTypes is empty:
            continue
        availableHotels.append({ hotel: hotel, roomTypeIds: availableRoomTypes, invMeta: inv })

    if availableHotels is empty:
        return { results: [] }

    // 5. get pricing for each hotel's available room types
    results = []
    for each item in availableHotels:
        pricingReq = {
          hotel_id: item.hotel.hotel_id,
          room_type_ids: item.roomTypeIds,
          check_in_date: checkIn,
          check_out_date: checkOut
        }
        pricingResp = PricingAPI.quote(pricingReq)
        // pricingResp.items: [{room_type_id, total_price, currency, price_version, as_of, stale}, ...]

        if pricingResp failed or pricingResp.items is empty:
            // Option: skip hotel or mark price unavailable; here we skip
            continue

        // 6. compute lowest price for hotel
        lowest = min(pricingResp.items, by = total_price)
        results.append({
           hotel_id: item.hotel.hotel_id,
           name: item.hotel.name,
           thumbnail: item.hotel.thumbnail,
           lowest_price: { amount: lowest.total_price, currency: lowest.currency },
           price_version: lowest.price_version,
           as_of: mergeTimestamps(item.invMeta.as_of, lowest.as_of),
           stale: item.invMeta.stale OR lowest.stale
        })

    // 7. return assembled list (no ranking/limits applied here)
    return { as_of: now(), results: results }

```

---

```
Inventory SQL: find hotel_ids that have at least one room_type fully available for the full date range
```

```
- Step 1: pre-filter hotels by location (from hotels table)
- Step 2: find room_type that is available for the entire date range.
```

<span style="color:green;font-weight:bold"> Response Body</span>

```
{
  "as_of": "2025-09-04T12:00:00Z",
  "results": [
    {
      "hotel_id": 101,
      "name": "Grand Goa Resort",
      "thumbnail": "https://cdn.example.com/hotels/101/thumb.jpg",
      "lowest_price": { "amount": 4000.00, "currency": "INR" },
      "price_version": "v2025.09.04.3",
      "as_of": "2025-09-04T11:59:20Z",
      "stale": false
    },
    ...
  ]
}
```

<span style="color:green;font-weight:bold">Load Estimation</span>

```
- Assumption: Daily Active Users (DAU) = 5 Million
- Assumption: Average Search Requests per User per Day = 5

- Total Requests per Day = 5M * 5 = 25M
- Average RPS = 25,000,000 / (86,400) ≈ 250 RPS

- Assumption: Peak Load Factor = 5x
- Peak RPS = 250 * 5 ≈ 1,250 RPS
```

---
### Hotel Service

View Details of Selected Hotel

<span style="color:purple;font-weight:bold">Sample Request Body</span>

<span style="color:purple;font-weight:bold">Business Logic</span>

<span style="color:purple;font-weight:bold">Sample Response Body</span>

<span style="color:purple;font-weight:bold">Load Estimation</span>

```
- Assumption: 50% of users view details after search
- Assumption: Average View Details Requests per User per Day = 2

- Total Requests per Day = 5M * 50% * 2 = 5,000,000
- Average RPS = 5,000,000 / (86,400) ≈ 50 RPS

- Assumption: Peak Load Factor = 5x
- Peak RPS = 50 * 5 ≈ 250 RPS
```

---
### Reservation Service

Book a Hotel Room

<span style="color:purple;font-weight:bold">Sample Request Body</span>

<span style="color:purple;font-weight:bold">Business Logic</span>

<span style="color:purple;font-weight:bold">Sample Response Body</span>

<span style="color:purple;font-weight:bold">Load Estimation</span>

```
- Assumption: 2% of users make a booking per day
- Assumption: Average Booking Requests per User per Day = 1

- Total Requests per Day = 5M * 2% = 100,000
- Average RPS = 100,000 / (24 * 60 * 60) ≈ 1 RPS

- Assumption: Peak Load Factor = 5x
- Peak RPS = 1 * 5 = 5 RPS
```

---
### EXTRA

### User API

handle sign up requests

<span style="color:purple;font-weight:bold">Sample Request Body</span>

<span style="color:purple;font-weight:bold">Business Logic</span>

<span style="color:purple;font-weight:bold">Sample Response Body</span>

<span style="color:purple;font-weight:bold">Load Estimation</span>

```
- Assumption: Daily Active Users (DAU) = 5 Million
- Assumption: 20% of DAU log in per day

- Total Requests per Day = 5M * 20% = 1M
- Average RPS = 1,000,000 / (24 * 60 * 60) ≈ 10 RPS

- Assumption: Peak Load Factor = 5x
- Peak RPS = 10 * 5 ≈ 50 RPS
```

> Design Choice: Keep IAM API (for sign in and api requests) separate from User API

---
