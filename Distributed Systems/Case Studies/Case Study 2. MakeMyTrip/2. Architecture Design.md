
Designing a scalable architecture begins with understanding the scale of the problem. **Back-of-the-envelope estimations** help us approximate critical metrics like **traffic load**, **storage requirements**, and **bandwidth usage**, which in turn influence key architectural decisions such as the number of **application servers**, **database sharding strategies**, **caching mechanisms**, and overall **network design**.

By doing these quick calculations early, we avoid over-engineering and ensure the system can gracefully handle both current and future demand. Let’s perform these estimations for our **Hotel Reservation System**.

![back-of-the-envelope-estimation](back-of-the-envelope-estimation.png)

---
### Load Estimation

Understanding how much traffic the system will handle is essential for designing a robust and scalable architecture. 

The most critical step in this process is identifying the **Daily Active Users (DAU)**. Once we know how many users are actively engaging with the platform each day, we can estimate <span style="color:green;font-weight:bold;background:beige;">peak hour load</span>, derive <span style="color:green;font-weight:bold;background:beige;">requests per second (RPS)</span>, and evaluate the <span style="color:green;font-weight:bold;background:beige;">read / write ratio</span> across different user actions.

```
- Assumption: Daily Active Users (DAU) = 5 Million
```

The next step is analyzing <span style="color:green;font-weight:bold;background:beige;">how traffic distributes across different user actions</span>. Let’s estimate the load for the three core operations: 

<span style="color:purple;font-weight:bold">Search Hotels</span>

```
- Assumption: Average Search Requests per User per Day = 5

- Total Requests per Day = 5M * 5 = 25M
- Average RPS = 25,000,000 / (24 * 60 * 60) ≈ 250 RPS

- Assumption: Peak Load Factor = 5x
- Peak RPS = 250 * 5 ≈ 1,250 RPS
```

<span style="color:purple;font-weight:bold">View Details of Selected Hotel</span>

```
- Assumption: 50% of users view details after search
- Assumption: Average View Details Requests per User per Day = 2

- Total Requests per Day = 5M * 50% * 2 = 5,000,000
- Average RPS = 5,000,000 / (24 * 60 * 60) ≈ 50 RPS

- Assumption: Peak Load Factor = 5x
- Peak RPS = 50 * 5 ≈ 250 RPS
```

<span style="color:purple;font-weight:bold">Book a Hotel Room</span>

```
- Assumption: 2% of users make a booking per day
- Assumption: Average Booking Requests per User per Day = 1

- Total Requests per Day = 5M * 2% = 100,000
- Average RPS = 100,000 / (24 * 60 * 60) ≈ 1 RPS

- Assumption: Peak Load Factor = 5x
- Peak RPS = 1 * 5 = 5 RPS
```

<span style="color:green;font-weight:bold">Summary</span>

| Operation          | Total Requests / Day | Avg RPS | Peak RPS |
| ------------------ | -------------------- | ------- | -------- |
| Search Hotels      | 25,000,000           | 250     | 1,250    |
| View Hotel Details | 5,000,000            | 50      | 250      |
| Book Hotel Room    | 100,000              | 1       | 5        |

---
### Storage Estimation

Designing a scalable system requires a clear understanding of how much data the platform needs to store and manage over time. **Storage estimation** helps us anticipate database size, plan for indexing, implement backup strategies, and decide whether to adopt **sharding or archiving** for future growth. 

Let's estimate the storage requirements for key entities:

<span style="color:purple;font-weight:bold">Hotel</span>

The **Hotel entity** serves as the foundation for the booking platform, providing the details users need to discover and evaluate hotels before making a reservation. It would contain metadata such as:

```
- Hotel ID: ~16 bytes (UUID or numeric ID)
- Name: ~100 bytes (typically under 50 characters)
- Location: ~250 bytes (full address, city, state, country)  
- Description: ~2 KB (maximum 2,000 characters)
- Amenities: ~500 bytes (list of 10 amenities, e.g., “Wi-Fi, Pool”)
- Images Metadata: ~2 KB (10 image URLs, each ~200 bytes)
```

Based on these field-level estimates, we can now approximate the overall storage required for hotels:

```
- Assumption: Total Hotels = 1 Million
- Average Hotel Record Size = 5 KB (with indexes & overhead)
- Total Storage for Hotels = 1,000,000 × 5 KB = 5 GB
```

> **NOTE:** Assuming each hotel has **10 images** and each image is around **500 KB**, the total storage required for storing all images would be: `1,000,000 × 10 × 500 KB = 5,000,000,000 KB = 5 TB`.

<span style="color:purple;font-weight:bold">Room</span>

If rooms were stored as an **embedded list inside the Hotel entity**, updating a single room (e.g., changing its availability or price) would require **updating the entire hotel record**. This could lead to **write conflicts** and require **locking the whole hotel record**, reducing performance under high load. 

By keeping **Room** as a separate entity, each room can be updated independently, minimising lock contention and improving **scalability**, **performance**, and **concurrency handling**.

```
- Room ID: ~16 bytes (UUID or numeric ID)
- Room Type: ~100 bytes (e.g., "Deluxe", "Standard")  
- Price: ~50 bytes (price value + currency)  
- Availability: ~250 bytes (calendar)  
- Other Attributes: ~500 bytes (bed type, occupancy, amenties, etc.)
```

```
- Assumption: Average Rooms per Hotel = 100
- Average Room Record Size = 1 KB (with indexes & overhead)  
- Total Storage for Rooms = 1,000,000 * 100 * 1 KB = 100 GB
```

<span style="color:purple;font-weight:bold">Users</span>

This entity forms the basis for identity management, personalization, and secure access across the platform.

```
- User ID: ~16 bytes (UUID or numeric ID)
- Name: ~100 bytes (First Name + Last Name)
- Email: ~100 bytes (can be long, e.g., corporate emails)
- Phone Number: ~20 bytes (include country code + separators)
- Hashed Password: ~256 bytes (depending on algorithm)
- Other Attributes: ~500 bytes (profile image URL, addresses, etc.)
```

```
- (Assumption) Total Registered Users: 50 Million
- Average User Record Size: 1 KB (with indexes & overhead)
- Total Storage = 50,000,000 * 1 KB = 50,000,000 KB = 50 GB
```

<span style="color:purple;font-weight:bold">Bookings</span>

This entity represents the transactional data that links a user to a specific room in a hotel for a defined date range.

```
- User ID: ~16 bytes (UUID or numeric ID)
- Hotel ID: ~16 bytes
- Room ID: ~16 bytes
- Dates: ~32 bytes (check-in and check-out dates)
- Payment status: ~20 bytes (e.g., “Paid”, “Pending”)
- Other Attributes: ~500 bytes (created timestamp, updated timestamp, etc.)
```

Since booking records are transactional in nature, they are most frequently queried within the first **12 months** (for cancellations, modifications, customer support, disputes, etc.). After this retention window, the likelihood of accessing historical bookings drops significantly.

```
- Assumption: Daily Bookings = 100,000 (from load estimation)
- Assumption: Booking Retention = 1 year (365 days)
- Total Bookings per Year = 100,000 * 365 = 36.5 Million
- Booking Record Size = 1 KB (with indexes & overhead)
- Total Storage for Bookings = 36,500,000 * 1 KB = 36.5 GB
```

> **NOTE:** To optimize performance and reduce storage costs, move older bookings from the **OLTP (Online Transaction Processing) database** to an **OLAP (Online Analytical Processing) database**.

<span style="color:green;font-weight:bold">Summary</span>

| **Entity**       | **Assumptions**                       | **Estimated Size per Record** | **Total Records** | **Total Storage** |
| ---------------- | ------------------------------------- | ----------------------------- | ----------------- | ----------------- |
| **Hotels**       | 1M hotels                             | 5 KB                          | 1,000,000         | 5 GB              |
| **Hotel Images** | 10 images per hotel                   | 500 KB                        | 10,000,000        | 5 TB              |
| **Rooms**        | 100 rooms per hotel                   | 1 KB                          | 100,000,000       | 100 GB            |
| **Users**        | 50M users                             | 1 KB                          | 50,000,000        | 50 GB             |
| **Bookings**     | 1M daily bookings retained for 1 year | 1 KB                          | 36,500,000        | 36.5 GB           |

---
### Bandwidth Estimation

**Bandwidth estimation** measures how much data flows into and out of the system each second. Quantifying data flowing through the system helps us size network throughput, justify **caching**, and decide where a **CDN** is essential.

Let's estimate the network throughput for the three core operations:

<span style="color:purple;font-weight:bold">Search Hotels</span>

<span style="color:red;">(Inbound network throughput)</span>

```
- Assumption: 20 Hotel Records sent per Request (pagination)
- Single Hotel Record Size ≈ 5 KB

- Average RPS ≈ 250 RPS
- Average Bandwidth = 20 * 5 KB * 250 RPS 
					= 25,000 KB/s
					≈ 25 MB/s
					= 200 Mbps 

- Peak RPS ≈ 1,250 RPS
- Peak Bandwidth = 20 * 5 KB * 1,250 RPS
				 = 125,000 KB/s
				 ≈ 125 MB/s
				 = 1000 Mbps (~1 Gbps)
```

<span style="color:purple;font-weight:bold">View Details of Selected Hotel</span>

<span style="color:red;">(Inbound network throughput)</span>

```
- Assumption: 10 images fetched sent per Request (load estimation)
- Average Payload Size = Single Hotel Record Size + 10 Images Size 
					   = 5 KB + 10 * 500 KB ≈ 5 MB 

- Average RPS ≈ 50 RPS
- Average Bandwidth = 5 MB * 50 RPS
					= 250 MB/s
					= 2000 Mbps

- Peak RPS ≈ 250 RPS
- Peak Bandwidth = 5 MB * 250 RPS
				 = 1250 MB/s
				 = 10,000 Mbps (~10 Gbps)
```

<span style="color:purple;font-weight:bold">Book a Hotel Room</span>

<span style="color:red;">(Outbound network throughput)</span>

```
- Payload Size = 1 KB

- Average RPS = 1 RPS
- Average Bandwidth = 1 KB * 1 RPS = 1 KB/s ≈ 0.008 Mbps

- Peak RPS = 5 RPS
- Peak Bandwidth = 1 KB * 5 RPS = 5 KB/s ≈ 0.04 Mbps
```

---
### System Architecture


<span style="color:green;font-weight:bold;">AWS Implementation</span>

```
AWS System Architecture
```

---



