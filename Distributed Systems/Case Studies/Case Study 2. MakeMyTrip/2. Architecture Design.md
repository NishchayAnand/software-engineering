
Designing a scalable architecture begins with understanding the scale of the problem. **Back-of-the-envelope estimations** help us approximate critical metrics like **traffic load**, **storage requirements**, and **bandwidth usage**, which in turn influence key architectural decisions such as the number of **application servers**, **database sharding strategies**, **caching mechanisms**, and overall **network design**.

By doing these quick calculations early, we avoid over-engineering and ensure the system can gracefully handle both current and future demand. Let’s perform these estimations for our **Hotel Reservation System**.

![back-of-the-envelope-estimation](back-of-the-envelope-estimation.png)

---
### Load Estimation

Understanding how much traffic the system will handle is essential for designing a robust and scalable architecture. 

The most critical step in this process is identifying the **Daily Active Users (DAU)**. Once we know how many users are actively engaging with the platform each day, we can estimate <span style="color:green;font-weight:bold;background:beige;">peak hour load</span>, derive <span style="color:green;font-weight:bold;background:beige;">requests per second (RPS)</span>, and evaluate the <span style="color:green;font-weight:bold;background:beige;">read / write ratio</span> across different user actions.

```
- Assumption: Daily Active Users (DAU) = 5 Million
```

The next step is analyzing <span style="color:green;font-weight:bold;background:beige;">how traffic distributes across different user actions</span>. Let’s estimate the load for the three core operations: 

<span style="color:purple;font-weight:bold">Search Hotels</span>

```
- Assumption: Average Search Requests per User per Day = 5
- Total Requests per Day = 5M * 5 = 25M
- Average RPS = 25,000,000 / (24 * 60 * 60) ≈ 250 RPS

- Assumption: Peak Load Factor = 5x
- Peak RPS = 250 * 5 ≈ 1,250 RPS
```

<span style="color:purple;font-weight:bold">View Details of Selected Hotel</span>

```
- Assumption: 50% of users view details after search
- Assumption: Average View Details Requests per User per Day = 2
- Total Requests per Day = 5M * 50% * 2 = 5,000,000
- Average RPS = 5,000,000 / (24 * 60 * 60) ≈ 50 RPS

- Assumption: Peak Load Factor = 5x
- Peak RPS = 50 * 5 ≈ 250 RPS
```

<span style="color:purple;font-weight:bold">Book a Hotel Room</span>

```
- Assumption: 2% of users make a booking per day
- Assumption: Average Booking Requests per User per Day = 1
- Total Requests per Day = 5M * 2% = 100,000
- Average RPS = 100,000 / (24 * 60 * 60) ≈ 1 RPS

- Assumption: Peak Load Factor = 5x
- Peak RPS = 1 * 5 ≈ 6 RPS
```

<span style="color:green;font-weight:bold">Summary</span>

| Operation          | Total Requests / Day | Avg RPS | Peak RPS |
| ------------------ | -------------------- | ------- | -------- |
| Search Hotels      | 25,000,000           | 250     | 1,250    |
| View Hotel Details | 5,000,000            | 50      | 250      |
| Book Hotel Room    | 100,000              | 1       | 5        |

---
### Storage Estimation

Designing a scalable system requires a clear understanding of how much data the platform needs to store and manage over time. **Storage estimation** helps us anticipate database size, plan for indexing, implement backup strategies, and decide whether to adopt **sharding or archiving** for future growth. 

Let's estimate the storage requirements for key entities:

<span style="color:purple;font-weight:bold">Hotels</span>

```

```

<span style="color:purple;font-weight:bold">Rooms</span>

```

```

<span style="color:purple;font-weight:bold">Users</span>

```

```

<span style="color:purple;font-weight:bold">Bookings</span>

```

```

<span style="color:purple;font-weight:bold">Summary</span>

| Entity   | Count           | Avg Size | Total Storage |
| -------- | --------------- | -------- | ------------- |
| Hotels   | 1,000,000       | 5 KB     | 5 GB          |
| Rooms    | 100,000,000     | 1 KB     | 100 GB        |
| Users    | 50,000,000      | 1 KB     | 50 GB         |
| Bookings | 36,500,000/year | 1 KB     | 36.5 GB       |

---
### Bandwidth Estimation

---
### System Architecture

---
### EXTRA

- Hotels To Cater - 1,00,000 (business aspiration)
- Average room count = 50 (business decision)
- Total Rooms = 5 M
- Average photo count per hotel = 20
- Average size of photos = 2 MB
- Total space required = 1,00,000 x 20 x 2 = 40,00,000 MB = 4 TB (imp)

Booking storage estimation 

1M hotels, 100 rooms, 5 room types = 100 million, 5 million room types 

- 5000 hotels -> 1 million rooms 
- customers pay online 
- support cancellation
- allow 10% overbooking ???
- show hotel details page 
- show hotel room-related detail page
- Reserve a room
- admin panel to add / remove / update hotel or room info
- hotel prices can change dynamically. **The price of a hotel room depends on hoe full the hotel is expected to be on a given day.** For now, we can assume the price could be different each day.
- Support high concurrency. During peak season or some big events, some popular hotels may have a lot of customers trying to book the same room.
- Moderate latency. It's okay for the system to take few seconds for processing a reservation request.

internal API like admin APIs can use RPC such as gRPC.

---

- Customer should be able to search hotels for a specific location and for a specific date range. 
- Customer can reserve one or more rooms in a hotel.
- Customer can cancel the booking. 


## EXTRA

- cancelBooking(Booking) -> Booking: Hotel, StartDate, EndDate, IsPaid etc. 

## LINKS

- https://www.youtube.com/watch?v=kO0EQNfE2x4


